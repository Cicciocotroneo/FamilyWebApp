<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Family Hub</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
    <style>
        /* --- STILI GENERALI --- */
        body { background-color: #f4f6f8; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; -webkit-tap-highlight-color: transparent; }
        
        /* HEADER */
        header { 
            background: white; padding: 15px 20px; position: sticky; top: 0; z-index: 100; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; 
        }
        .header-controls { display: flex; align-items: center; gap: 15px; } /* Più spazio tra icone */
        
        /* --- OTTIMIZZAZIONE BARRA INSERIMENTO (MOBILE GRID) --- */
        .add-bar {
            background: white;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            display: grid;
            grid-template-columns: 1fr 1fr; /* Griglia a 2 colonne */
            gap: 12px; /* Spazio tra i campi */
        }

        /* Stile comune per input e select: grandi e comodi */
        .add-bar select, .add-bar input {
            width: 100%;
            height: 48px; /* Altezza comoda per il dito */
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            background-color: #f9f9f9;
            font-size: 16px; /* Evita zoom su iPhone */
            padding: 0 12px;
            color: #333;
            box-sizing: border-box; /* Importante per i bordi */
            appearance: none; /* Rimuove lo stile default brutto */
            -webkit-appearance: none;
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23333%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
            background-repeat: no-repeat;
            background-position: right 12px top 50%;
            background-size: 10px auto;
        }

        /* Input testo non ha la freccia */
        .add-bar input { background-image: none; }

        /* Colori specifici per differenziare */
        #assign-who { background-color: #fff8e1; border-color: #ffecb3; color: #ff6f00; font-weight: 500; }
        #date-input { font-family: sans-serif; }

        /* Gruppo Input Testo + Bottone (Occupa tutta la larghezza in basso) */
        .input-text-group {
            grid-column: 1 / -1; /* Spazia su entrambe le colonne */
            display: flex;
            gap: 10px;
            margin-top: 5px;
        }

        #new-item-input {
            flex-grow: 1;
            background: white;
            border: 2px solid #4285f4; /* Bordo blu per evidenziare dove scrivere */
        }
        
        #contact-detail-input {
             grid-column: 1 / -1; /* Anche la rubrica prende tutto lo spazio */
        }

        #add-btn {
            width: 50px; height: 48px;
            background: #4285f4; color: white; border: none; border-radius: 12px;
            font-size: 24px; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px rgba(66, 133, 244, 0.3);
            cursor: pointer;
        }
        #add-btn:active { transform: scale(0.95); }

        /* --- CLASSI DI UTILITÀ PER NASCONDERE CAMPI --- */
        /* Sovrascriviamo la classe hidden per il layout grid */
        .hidden { display: none !important; }

        /* --- STILI LISTE E CARD (Invariati ma puliti) --- */
        .card { background: white; padding: 16px; margin-bottom: 12px; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; }
        .date-badge { background: #e8f0fe; color: #1967d2; padding: 6px 10px; border-radius: 10px; text-align: center; margin-right: 15px; min-width: 48px; display: flex; flex-direction: column; justify-content: center; font-weight: bold; }
        .date-day { font-size: 1.4rem; line-height: 1; }
        .date-month { font-size: 0.7rem; text-transform: uppercase; margin-top: 2px; }
        
        .cat-dot { height: 12px; width: 12px; border-radius: 50%; display: inline-block; margin-right: 8px; vertical-align: middle; }
        .assigned-badge { font-size: 0.75rem; background: #eee; color: #555; padding: 3px 8px; border-radius: 6px; margin-left: 8px; display: inline-block; vertical-align: middle; }
        
        /* Bottom Nav */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: white; border-top: 1px solid #eee; display: flex; justify-content: space-around; padding: 12px 0 25px 0; z-index: 200; box-shadow: 0 -2px 10px rgba(0,0,0,0.03); }
        .nav-item { background: none; border: none; color: #999; display: flex; flex-direction: column; align-items: center; font-size: 0.7rem; }
        .nav-item.active { color: #4285f4; }
        .nav-item i { font-size: 26px; margin-bottom: 4px; }
        
        /* Pagine Admin/Impostazioni */
        .settings-view { padding: 20px; }
        .settings-section { background: white; border-radius: 12px; padding: 15px; margin-bottom: 15px; }
        .settings-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f0f0f0; }
        
        /* Login */
        #auth-container { height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 30px; background: white; }
        #auth-container input { width: 100%; height: 50px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 10px; padding: 0 15px; font-size: 16px; box-sizing: border-box; }
        #login-btn { width: 100%; height: 50px; background: #4285f4; color: white; border: none; border-radius: 10px; font-size: 18px; font-weight: bold; }

        /* Filtri Header */
        #filter-select { border: none; background: #f0f2f5; padding: 8px 12px; border-radius: 8px; font-weight: 600; color: #333; font-size: 0.9rem; }
    </style>
</head>
<body>

    <div id="auth-container">
        <h1 style="color:#4285f4; font-size: 2.5rem; margin-bottom: 10px;">Family Hub</h1>
        <p style="color:#888; margin-bottom: 40px;">Il centro della tua casa.</p>
        <input type="email" id="email-input" placeholder="Email">
        <input type="password" id="password-input" placeholder="Password">
        <button id="login-btn">Entra</button>
        <p id="login-status" style="margin-top: 20px; color: #666; font-size: 0.9rem;"></p>
    </div>

    <div id="app-container" class="hidden">
        <header>
            <div>
                <h2 id="page-title" style="margin:0; font-size: 1.4rem;">Agenda</h2>
                <span id="family-display" style="font-size:0.75rem; color:#888; font-weight: 500;">Caricamento...</span>
            </div>
            <div class="header-controls">
                <select id="filter-select" onchange="window.applyFilter()">
                    <option value="all">Tutti</option>
                </select>
                <i class="material-icons" onclick="window.nav('settings')" style="color:#555; cursor:pointer;">settings</i>
                <i class="material-icons" onclick="window.logout()" style="color:#333; cursor:pointer;">logout</i>
            </div>
        </header>

        <main style="padding: 15px; padding-bottom: 100px;">
            
            <div id="add-bar-container" class="add-bar">
                
                <input type="date" id="date-input" class="hidden">
                <select id="recurrence-select" class="hidden">
                    <option value="none">1 volta</option>
                    <option value="weekly">Settimana</option>
                    <option value="monthly">Mese</option>
                    <option value="yearly">Anno</option>
                </select>

                <select id="category-select" class="hidden"></select>
                <select id="assign-who" class="hidden"></select>

                <input type="text" id="contact-detail-input" class="hidden" placeholder="Numero o Email">

                <div class="input-text-group">
                    <input type="text" id="new-item-input" placeholder="Aggiungi...">
                    <button id="add-btn"><i class="material-icons">add</i></button>
                </div>
            </div>

            <div id="list-container"></div>

            <div id="settings-view" class="hidden settings-view">
                <h3 style="margin-top:0;">Gestione Famiglia</h3>
                
                <div class="settings-section">
                    <h4 style="margin:0 0 10px 0;">Sicurezza</h4>
                    <div class="settings-row">
                        <span>PIN Admin</span>
                        <div style="display:flex; gap:10px;">
                            <input type="text" id="admin-pin-input" style="width:70px; text-align:center; margin:0;" maxlength="4">
                            <button onclick="window.savePin()" style="background:#4285f4; color:white; border:none; padding:5px 15px; border-radius:8px;">Salva</button>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <h4 style="margin:0 0 10px 0;">Membri</h4>
                    <div id="members-list"></div>
                    <div style="display:flex; gap:10px; margin-top:10px;">
                        <input type="text" id="new-member-name" placeholder="Nuovo membro" style="margin:0; flex-grow:1;">
                        <button onclick="window.addMember()" style="background:#4285f4; color:white; border:none; width:40px; border-radius:8px;">+</button>
                    </div>
                </div>

                <div class="settings-section">
                    <h4 style="margin:0 0 10px 0;">Categorie</h4>
                    <div id="categories-list"></div>
                    <div style="display:flex; gap:10px; margin-top:10px;">
                        <input type="text" id="new-cat-name" placeholder="Categoria" style="margin:0; flex-grow:1;">
                        <input type="color" id="new-cat-color" value="#4285f4" style="width:40px; padding:0; height:40px; border:none; border-radius:50%; margin:0;">
                        <button onclick="window.addCategory()" style="background:#4285f4; color:white; border:none; width:40px; border-radius:8px;">+</button>
                    </div>
                </div>
            </div>
        </main>

        <nav class="bottom-nav">
            <button class="nav-item" onclick="window.nav('calendar')"><i class="material-icons">event</i> Agenda</button>
            <button class="nav-item active" onclick="window.nav('shopping')"><i class="material-icons">shopping_cart</i> Spesa</button>
            <button class="nav-item" onclick="window.nav('todos')"><i class="material-icons">check_circle</i> Compiti</button>
            <button class="nav-item" onclick="window.nav('contacts')"><i class="material-icons">contacts</i> Rubrica</button>
            <button class="nav-item" onclick="window.nav('notes')"><i class="material-icons">sticky_note_2</i> Note</button>
        </nav>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, doc, updateDoc, query, orderBy, serverTimestamp, getDoc, setDoc } 
        from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } 
        from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // --- CONFIGURAZIONE FIREBASE (INCOLLA QUI I TUOI DATI) ---
        const firebaseConfig = {
  apiKey: "AIzaSyCV51Ge3znsE6TPnQrJeEiNasz5YXtFWXk",
  authDomain: "drgfamilyhub.firebaseapp.com",
  projectId: "drgfamilyhub",
  storageBucket: "drgfamilyhub.firebasestorage.app",
  messagingSenderId: "709925755710",
  appId: "1:709925755710:web:6ebb2967fbc107447f6a6f"
};
        // ---------------------------------------------

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        let currentSection = 'shopping';
        let currentFamily = null;
        let unsubscribe = null; 
        let allDataCache = []; 
        let familySettings = { pin: "0000", members: ["Mamma", "Papà"], categories: [{name:"Casa", color:"#4285f4"}] };

        // DOM REFERENCES
        const authContainer = document.getElementById('auth-container');
        const appContainer = document.getElementById('app-container');
        const listContainer = document.getElementById('list-container');
        const settingsView = document.getElementById('settings-view');
        const addBarContainer = document.getElementById('add-bar-container');
        const loginStatus = document.getElementById('login-status');
        
        // Inputs
        const categorySelect = document.getElementById('category-select');
        const assignWho = document.getElementById('assign-who');
        const filterSelect = document.getElementById('filter-select');
        const dateInput = document.getElementById('date-input');
        const recurrenceSelect = document.getElementById('recurrence-select');
        const contactInput = document.getElementById('contact-detail-input');
        const newItemInput = document.getElementById('new-item-input');

        // LOGIN
        document.getElementById('login-btn').addEventListener('click', () => {
            const email = document.getElementById('email-input').value;
            const pass = document.getElementById('password-input').value;
            if(!email || !pass) return;
            loginStatus.innerText = "Accesso...";
            signInWithEmailAndPassword(auth, email, pass).catch(e => loginStatus.innerText = "Errore: " + e.message);
        });

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                try {
                    const userDoc = await getDoc(doc(db, "registro_utenti", user.email));
                    if (userDoc.exists()) {
                        currentFamily = userDoc.data().famiglia;
                        authContainer.classList.add('hidden');
                        appContainer.classList.remove('hidden');
                        document.getElementById('family-display').innerText = `Famiglia: ${currentFamily}`;
                        await loadSettings();
                        loadData(currentSection);
                    } else { alert("Utente non configurato."); signOut(auth); }
                } catch (error) { loginStatus.innerText = "Errore connessione."; }
            } else { authContainer.classList.remove('hidden'); appContainer.classList.add('hidden'); }
        });

        window.logout = () => signOut(auth);

        // SETTINGS
        async function loadSettings() {
            onSnapshot(doc(db, "settings", currentFamily), (docSnap) => {
                if (docSnap.exists()) familySettings = { ...familySettings, ...docSnap.data() };
                else setDoc(doc(db, "settings", currentFamily), familySettings);
                renderDropdowns(); renderSettingsView();
            });
        }
        async function saveSettings() { await setDoc(doc(db, "settings", currentFamily), familySettings); }
        window.savePin = async () => {
            const newPin = document.getElementById('admin-pin-input').value;
            if(newPin.length >= 4) { familySettings.pin = newPin; await saveSettings(); alert("PIN Salvato"); }
        };

        function renderDropdowns() {
            categorySelect.innerHTML = "";
            familySettings.categories.forEach(cat => categorySelect.innerHTML += `<option value="${cat.name}">${cat.name}</option>`);
            filterSelect.innerHTML = `<option value="all">Tutti</option>`;
            familySettings.categories.forEach(cat => filterSelect.innerHTML += `<option value="${cat.name}">${cat.name}</option>`);
            assignWho.innerHTML = `<option value="">Per: Tutti</option>`;
            familySettings.members.forEach(mem => assignWho.innerHTML += `<option value="${mem}">${mem}</option>`);
        }

        // NAVIGAZIONE MIGLIORATA
        window.nav = (section) => {
            if (section === 'settings') {
                const pin = prompt("PIN Amministratore:");
                if (pin !== familySettings.pin) return alert("PIN Errato");
                
                currentSection = 'settings';
                listContainer.classList.add('hidden');
                addBarContainer.classList.add('hidden'); // Nasconde la barra input
                settingsView.classList.remove('hidden');
                document.getElementById('page-title').innerText = "Impostazioni";
                return;
            }

            currentSection = section;
            listContainer.classList.remove('hidden');
            addBarContainer.classList.remove('hidden');
            settingsView.classList.add('hidden');

            document.querySelectorAll('.nav-item').forEach(btn => btn.classList.remove('active'));
            if(event && event.currentTarget) event.currentTarget.classList.add('active'); 
            
            // RESET VISIBILITÀ CAMPI (Usa la classe hidden)
            dateInput.classList.add('hidden');
            recurrenceSelect.classList.add('hidden');
            categorySelect.classList.add('hidden'); 
            assignWho.classList.add('hidden');
            contactInput.classList.add('hidden');
            newItemInput.placeholder = "Aggiungi...";
            
            // LOGICA SPECIFICA PER SEZIONE
            const title = document.getElementById('page-title');
            
            if(section === 'calendar') {
                title.innerText = "Agenda";
                dateInput.classList.remove('hidden');
                recurrenceSelect.classList.remove('hidden'); 
                categorySelect.classList.remove('hidden'); // Usa display grid se togliamo hidden
                categorySelect.style.display = 'block'; // Forza display
                assignWho.classList.remove('hidden');
                assignWho.style.display = 'block';
                newItemInput.placeholder = "Evento...";
            } 
            else if (section === 'todos') {
                title.innerText = "Compiti";
                categorySelect.classList.remove('hidden');
                categorySelect.style.display = 'block';
                assignWho.classList.remove('hidden');
                assignWho.style.display = 'block';
                newItemInput.placeholder = "Compito...";
            } 
            else if (section === 'contacts') {
                title.innerText = "Rubrica";
                contactInput.classList.remove('hidden');
                newItemInput.placeholder = "Nome...";
            } 
            else if (section === 'shopping') {
                title.innerText = "Spesa";
                newItemInput.placeholder = "Cosa manca?";
            }
            else { title.innerText = "Note"; newItemInput.placeholder = "Scrivi..."; }

            loadData(section);
        };

        // RENDER SETTINGS VIEW
        function renderSettingsView() {
            document.getElementById('admin-pin-input').value = familySettings.pin;
            const memList = document.getElementById('members-list');
            memList.innerHTML = "";
            familySettings.members.forEach((mem, i) => {
                memList.innerHTML += `<div class="settings-row"><span>${mem}</span><i class="material-icons" style="color:red; cursor:pointer;" onclick="window.removeMember(${i})">delete</i></div>`;
            });
            const catList = document.getElementById('categories-list');
            catList.innerHTML = "";
            familySettings.categories.forEach((cat, i) => {
                catList.innerHTML += `<div class="settings-row"><div style="display:flex;align-items:center"><span style="width:20px;height:20px;background:${cat.color};border-radius:50%;margin-right:10px;"></span>${cat.name}</div><i class="material-icons" style="color:red; cursor:pointer;" onclick="window.removeCategory(${i})">delete</i></div>`;
            });
        }

        window.addMember = async () => { const n = document.getElementById('new-member-name').value; if(n){familySettings.members.push(n); await saveSettings(); document.getElementById('new-member-name').value="";}};
        window.removeMember = async (i) => { if(confirm("Eliminare?")){familySettings.members.splice(i,1); await saveSettings();}};
        window.addCategory = async () => { const n = document.getElementById('new-cat-name').value; const c=document.getElementById('new-cat-color').value; if(n){familySettings.categories.push({name:n, color:c}); await saveSettings(); document.getElementById('new-cat-name').value="";}};
        window.removeCategory = async (i) => { if(confirm("Eliminare?")){familySettings.categories.splice(i,1); await saveSettings();}};

        // DATA LOADING
        function loadData(section) {
            listContainer.innerHTML = '<div style="text-align:center; padding:30px; color:#ccc;">Caricamento...</div>';
            if (unsubscribe) unsubscribe();
            if (!currentFamily) return;
            const col = `${currentFamily}_${section}`;
            const sortField = section === 'calendar' ? 'date' : 'timestamp';
            const sortDir = section === 'calendar' ? 'asc' : 'desc';
            
            unsubscribe = onSnapshot(query(collection(db, col), orderBy(sortField, sortDir)), (snap) => {
                allDataCache = []; snap.forEach(d => allDataCache.push({id:d.id, ...d.data()}));
                renderList();
            });
        }

        window.applyFilter = () => renderList();

        function renderList() {
            listContainer.innerHTML = "";
            const filter = filterSelect.value;
            const filtered = allDataCache.filter(i => filter === 'all' || i.category === filter);
            
            if(filtered.length === 0) listContainer.innerHTML = "<div style='text-align:center;color:#ccc;margin-top:40px'>Nessun elemento.</div>";

            filtered.forEach(data => {
                const div = document.createElement('div'); div.className = 'card';
                const catObj = familySettings.categories.find(c => c.name === data.category);
                const color = catObj ? catObj.color : '#ccc';
                const assigned = data.assigned ? `<span class="assigned-badge">${data.assigned}</span>` : "";
                
                let html = "", actions = "";
                
                // Pulsanti Export
                if(currentSection === 'calendar' || currentSection === 'todos') {
                   const dStr = data.date || new Date().toISOString().split('T')[0];
                   actions = `<i class="material-icons" style="color:#ccc; margin-left:10px; cursor:pointer;" onclick="window.exportGoogle('${data.text}','${dStr}')">event</i>`;
                }

                if (currentSection === 'calendar') {
                    const d = new Date(data.date);
                    html = `<div class="date-badge"><span class="date-day">${d.getDate()}</span><span class="date-month">${d.toLocaleString('it-IT',{month:'short'})}</span></div>
                            <div style="flex-grow:1"><div style="font-weight:600; font-size:1.1rem; margin-bottom:4px;">${data.text}</div>
                            <div style="font-size:0.8rem; color:#666;"><span class="cat-dot" style="background:${color}"></span>${data.category||'Generale'} ${assigned}</div></div>`;
                } else if (currentSection === 'contacts') {
                    html = `<div style="flex-grow:1"><div style="font-weight:600; font-size:1.1rem;">${data.text}</div><a href="tel:${data.detail}" style="color:#4285f4; text-decoration:none; display:flex; align-items:center; margin-top:5px;"><i class="material-icons" style="font-size:16px; margin-right:5px;">call</i>${data.detail}</a></div>`;
                } else {
                    const strike = data.done ? 'text-decoration:line-through; color:#ccc;' : '';
                    const checkColor = data.done ? '#4285f4' : '#ccc';
                    html = `<i class="material-icons" style="color:${checkColor}; margin-right:15px; cursor:pointer;" onclick="window.toggle('${data.id}',${!data.done})">${data.done ? 'check_circle' : 'radio_button_unchecked'}</i>
                            <div style="flex-grow:1; ${strike}"><span class="cat-dot" style="background:${color}"></span>${data.text} ${assigned}</div>`;
                }

                div.innerHTML = `${html} <div style="display:flex; align-items:center;">${actions}<i class="material-icons" style="color:#ff5252; margin-left:15px; cursor:pointer;" onclick="window.del('${data.id}')">delete</i></div>`;
                listContainer.appendChild(div);
            });
        }

        // AZIONI DB
        document.getElementById('add-btn').addEventListener('click', async () => {
            const txt = newItemInput.value; if(!txt) return;
            const cat = categorySelect.value;
            const rec = recurrenceSelect.value;
            const who = assignWho.value;
            let dVal = dateInput.value;
            
            let loops = 1;
            if(currentSection === 'calendar' && rec !== 'none') loops = (rec==='weekly'?4 : (rec==='monthly'?6:5));

            for(let i=0; i<loops; i++) {
                const item = { text: txt, timestamp: serverTimestamp(), done: false, category: cat, assigned: who };
                if(currentSection === 'calendar') {
                    if(!dVal) return alert("Inserisci Data");
                    if(i>0) {
                        const d = new Date(dVal);
                        if(rec==='weekly') d.setDate(d.getDate()+(7*i));
                        if(rec==='monthly') d.setMonth(d.getMonth()+i);
                        if(rec==='yearly') d.setFullYear(d.getFullYear()+i);
                        item.date = d.toISOString().split('T')[0];
                    } else item.date = dVal;
                }
                if(currentSection === 'contacts') item.detail = contactInput.value || "";
                await addDoc(collection(db, `${currentFamily}_${currentSection}`), item);
                if(currentSection !== 'calendar') break;
            }
            newItemInput.value=""; contactInput.value=""; recurrenceSelect.value="none";
        });

        window.del = async (id) => { if(confirm("Eliminare?")) await deleteDoc(doc(db, `${currentFamily}_${currentSection}`, id)); };
        window.toggle = async (id, st) => { if(currentSection!=='calendar' && currentSection!=='contacts') await updateDoc(doc(db, `${currentFamily}_${currentSection}`, id), {done:st}); };
        
        window.exportGoogle = (t,d) => { const x=d.replace(/-/g,''); window.open(`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(t)}&dates=${x}/${x}`,'_blank');};

    </script>
</body>
</html>
